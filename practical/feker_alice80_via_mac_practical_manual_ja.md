# FEKER Alice 80 – VIA 実践設定マニュアル（macOS）

## この文書の目的

この文書は、**macOS 環境において FEKER Alice 80 を VIA で設定するために、
実際に必要だった手順と制約のみ**を記録した実践マニュアルです。

以下の内容は含みません：

- おすすめ配列
- 個人の好み
- 便利設定・チューニング

再現性を最優先し、事実として確認できた挙動のみを記載します。

---

## 対象環境

- macOS
- FEKER Alice 80
- VIA（デスクトップアプリ）

---

## macOS 側の事前設定

### ファンクションキーの挙動設定

macOS では、ファンクションキーが OS 側により消費されます。

以下を設定してください：

**システム設定 → キーボード → キーボードショートカット → ファンクションキー**

- ✅「F1、F2 などのキーを標準のファンクションキーとして使用」を有効化

この設定をしない場合：

- F10 などのキーがターミナルアプリに到達しない
- VIA のレイヤー設定が正しく動作していても反応しない

という状態になります。

---

### 入力監視（Input Monitoring）の許可

macOS では、一部のキー入力が
**入力監視（Input Monitoring）**権限を要求します。

以下を確認してください：

**システム設定 → プライバシーとセキュリティ → 入力監視**

許可する対象：

- Terminal.app
- iTerm2.app
- 使用しているその他のターミナルアプリ

Midnight Commander（mc）などの TUI アプリでは、
この権限がないと一部キー入力が認識されません。

---

## VIA が自動認識されない理由

FEKER Alice 80 は、**VIA の公式デバイスデータベースに登録されていません**。

そのため：

- USB HID デバイスとしては検出される
- しかし VIA が対応キーボードとして紐づけできない
- 結果として「Searching for device...」のまま進まない

これは異常ではなく、仕様通りの挙動です。

---

## VIA が「Searching for device...」で停止する理由（詳細）

FEKER Alice 80 は **VIA の公式デバイスデータベースに未登録**です。

そのため：

- VIA はキーボードを USB HID デバイスとしては検出できる
- しかし、キー配列・マトリクス・レイヤー情報を理解できない
- 結果として **VIA は JSON をロードしない限り配列を解釈できない**

この状態では：

- VIA は待機状態のまま進まず
- `Searching for device...` の表示で**永久に停止**します

これはエラーではなく、VIA の設計上の挙動です。

---

## Design タブが表示されていない場合

VIA の初期設定によっては、**Design タブが非表示**になっている場合があります。

その場合は以下を確認してください：

1. VIA を起動
2. **Settings タブ**を開く
3. **Show Design tab** にチェックを入れる
4. 画面上部に Design タブが表示される

Design タブが表示されていない状態では、
JSON ファイルを読み込むことができません。

---

## 必須手順（順不同不可）

以下の手順は**順番が重要**です。

1. キーボードの電源をオフ
2. USB ケーブルで有線接続
3. **Fn + N** を押して有線モードに切り替え
4. VIA を起動
5. **Design タブ**を開く
6. 公式の VIA JSON ファイルを手動で読み込む

Design タブから JSON を読み込まない限り、
VIA はこのキーボードを認識しません。

---

## Fn キーとレイヤーの挙動について

### 実際に確認された挙動

- VIA 標準のレイヤーキー（例：MO(1)）は正常に機能しない
- Fn キーを割り当てても Key Tester で反応しない
- レイヤー 0 から切り替わらない

---

### 動作が確認できた割り当て

以下のみが安定して動作しました：

- **Fn1(3)**

挙動：

- VIA 上では `Fn1(3)` と表示される
- キーに割り当てると正しくレイヤー切り替えが発生
- Key Tester で Layer 1 が確認できる

これは、FEKER 独自のファームウェア実装による
ベンダー依存仕様と思われます。

---

## ターミナルアプリでの挙動例（Midnight Commander）

Midnight Commander（mc）において：

- 設定前：  
  - `Fn + 0` → `0` が入力される  
  - F10 が効かず mc が終了できない

- `Fn1(3)` 設定後：  
  - レイヤー切替が発生
  - F10 が正常に認識される

---

## 設定の保存について

- VIA の設定はキーボード本体に書き込まれます
- macOS 側に常駐プロセスは不要
- 電源オフ・再起動後も設定は維持されます

---

## 無線モードへの復帰

設定完了後：

1. VIA を終了
2. USB ケーブルを外す
3. Bluetooth / 2.4GHz 無線モードへ切り替え

有線接続時に行った VIA 設定は、
無線モードでもそのまま有効です。

---

## 補足事項

- 公式 VIA JSON ファイルは別途ダウンロードします
- 本リポジトリでは公式 JSON は配布しません
- 本書の内容は実測・検証ベースで記載しています
